import{d as O,u as Q,o as R,c as u,a as n,w as a,b as h,r as i,e as _,f as r,g as s,t as l,h as d,i as v,j as c,k as L,F as W,l as X,m as Y}from"./index-BWLevX4m.js";import{u as Z}from"./configStore-B2mf_68t.js";import{v as D}from"./vikunjaApi-BsdAWamU.js";const ee={class:"pa-4"},ae={class:"va-h1 mb-6"},oe={key:1},se={class:"row row-equal mb-6"},le={class:"flex xs6 md3"},te={class:"flex xs6 md3"},ne={class:"flex xs6 md3"},re={class:"flex xs6 md3"},de={key:0,class:"mb-6"},ce={class:"va-h4"},ie={class:"row align--center"},ue={class:"flex xs12 md8"},ve={class:"va-h4"},_e={class:"va-text-secondary"},me={class:"flex xs12 md4"},he={class:"mb-6"},be={class:"va-h4"},pe={class:"va-text-secondary"},fe={key:1},ye={class:"mb-6"},ke={class:"va-h4"},ge={key:0,class:"va-text-secondary"},je={key:1},xe={class:"va-h4"},we={key:2},Ce={key:2},Ve={class:"va-h2 mb-4"},Pe=O({__name:"Dashboard",setup(De){const{t:e}=Q(),b=Z(),p=_("default"),k=_([]),g=_([]),N=_([]),m=_(null),T=_(!1),F=_(!1),z=h(()=>b.config),K=h(()=>b.loading),U=h(()=>b.error),j=h(()=>b.providers),M=h(()=>[{key:"id",label:"ID",sortable:!0},{key:"title",label:e("projects.projectName"),sortable:!0},{key:"description",label:e("providers.description"),sortable:!1},{key:"owner",label:e("dashboard.owner"),sortable:!1}]),$=h(()=>[{key:"id",label:"ID",sortable:!0},{key:"title",label:e("dashboard.taskTitle"),sortable:!0},{key:"priority",label:e("dashboard.priority"),sortable:!0},{key:"dueDate",label:e("dashboard.dueDate"),sortable:!0}]);function q(t){return t>=4?"danger":t>=3?"warning":t>=2?"info":"secondary"}function A(t){return t>=4?e("dashboard.priorityHigh"):t>=3?e("dashboard.priorityMedium"):t>=2?e("dashboard.priorityLow"):e("dashboard.priorityNone")}function E(t){return new Date(t).toLocaleDateString()}async function I(){if(p.value)try{await b.loadConfig(p.value),await H()}catch(t){console.error("Failed to load config:",t)}}async function H(){T.value=!0;try{k.value=await D.getProjects()}catch(t){console.error("Failed to load Vikunja projects:",t)}finally{T.value=!1}F.value=!0;try{g.value=await D.getTasks()}catch(t){console.error("Failed to load Vikunja tasks:",t)}finally{F.value=!1}try{N.value=await D.getLabels()}catch(t){console.error("Failed to load Vikunja labels:",t)}try{m.value=await D.getCurrentUser()}catch(t){console.error("Failed to load current user:",t)}}return R(()=>{I()}),(t,f)=>{const x=i("va-alert"),w=i("va-counter"),C=i("va-divider"),V=i("va-icon"),G=i("va-avatar"),y=i("va-chip"),S=i("va-data-table"),P=i("va-inner-loading"),B=i("va-button"),J=i("va-input");return r(),u("div",ee,[n(P,{loading:K.value},{default:a(()=>[s("h1",ae,l(d(e)("dashboard.title")),1),U.value?(r(),v(x,{key:0,color:"danger",class:"mb-6"},{default:a(()=>[c(l(U.value),1)]),_:1})):L("",!0),z.value?(r(),u("div",oe,[s("div",se,[s("div",le,[n(w,{"model-value":j.value.length,label:d(e)("dashboard.stats.providers"),color:"primary",icon:"notifications"},null,8,["model-value","label"])]),s("div",te,[n(w,{"model-value":k.value.length,label:d(e)("dashboard.stats.projects"),color:"success",icon:"folder"},null,8,["model-value","label"])]),s("div",ne,[n(w,{"model-value":g.value.length,label:d(e)("dashboard.stats.tasks"),color:"info",icon:"task"},null,8,["model-value","label"])]),s("div",re,[n(w,{"model-value":N.value.length,label:d(e)("dashboard.stats.labels"),color:"warning",icon:"label"},null,8,["model-value","label"])])]),m.value?(r(),u("div",de,[n(C,{class:"mb-4"},{default:a(()=>[s("span",ce,l(d(e)("dashboard.currentUser")),1)]),_:1}),s("div",ie,[s("div",ue,[n(G,{size:"large",color:"primary",class:"mr-3"},{default:a(()=>[n(V,{name:"person"})]),_:1}),s("div",null,[s("div",ve,l(m.value.name||m.value.username),1),s("div",_e,l(m.value.email),1)])]),s("div",me,[n(y,{color:"success",class:"mr-2"},{default:a(()=>[c(l(d(e)("dashboard.userActive")),1)]),_:1}),n(y,{color:"info"},{default:a(()=>[c("ID: "+l(m.value.id),1)]),_:1})])])])):L("",!0),s("div",he,[n(C,{class:"mb-4"},{default:a(()=>[s("span",be,l(d(e)("dashboard.vikunjaProjects")),1)]),_:1}),n(P,{loading:T.value},{default:a(()=>[k.value.length===0?(r(),v(x,{key:0,color:"info",border:"top"},{default:a(()=>[c(l(d(e)("dashboard.noProjects")),1)]),_:1})):(r(),v(S,{key:1,items:k.value,columns:M.value,striped:"",hoverable:""},{"cell(title)":a(({rowData:o})=>[n(V,{name:"folder",class:"mr-2"}),s("strong",null,l(o.title),1)]),"cell(description)":a(({rowData:o})=>[s("span",pe,l(o.description||"-"),1)]),"cell(owner)":a(({rowData:o})=>[o.owner?(r(),v(y,{key:0,size:"small",color:"primary"},{default:a(()=>[c(l(o.owner.name||o.owner.username),1)]),_:2},1024)):(r(),u("span",fe,"-"))]),_:1},8,["items","columns"]))]),_:1},8,["loading"])]),s("div",ye,[n(C,{class:"mb-4"},{default:a(()=>[s("span",ke,l(d(e)("dashboard.recentTasks")),1)]),_:1}),n(P,{loading:F.value},{default:a(()=>[g.value.length===0?(r(),v(x,{key:0,color:"info",border:"top"},{default:a(()=>[c(l(d(e)("dashboard.noTasks")),1)]),_:1})):(r(),v(S,{key:1,items:g.value.slice(0,10),columns:$.value,striped:"",hoverable:""},{"cell(title)":a(({rowData:o})=>[n(V,{name:o.done?"check_circle":"radio_button_unchecked",color:o.done?"success":"secondary",class:"mr-2"},null,8,["name","color"]),s("span",null,l(o.title),1)]),"cell(priority)":a(({rowData:o})=>[n(y,{size:"small",color:q(o.priority)},{default:a(()=>[c(l(A(o.priority)),1)]),_:2},1032,["color"])]),"cell(dueDate)":a(({rowData:o})=>[o.dueDate?(r(),u("span",ge,l(E(o.dueDate)),1)):(r(),u("span",je,"-"))]),_:1},8,["items","columns"]))]),_:1},8,["loading"])]),s("div",null,[n(C,{class:"mb-4"},{default:a(()=>[s("span",xe,l(d(e)("nav.providers")),1)]),_:1}),j.value.length===0?(r(),v(x,{key:0,color:"info",border:"top",class:"mb-3"},{default:a(()=>[c(l(d(e)("providers.add")),1)]),_:1})):L("",!0),j.value.length===0?(r(),v(B,{key:1,onClick:f[0]||(f[0]=o=>t.$router.push("/providers")),icon:"add"},{default:a(()=>[c(l(d(e)("providers.add")),1)]),_:1})):(r(),u("div",we,[(r(!0),u(W,null,X(j.value,o=>(r(),v(y,{key:o.providerType,color:"primary",class:"mr-2 mb-2"},{default:a(()=>[n(V,{name:"notifications",class:"mr-1"}),c(" "+l(o.name||o.providerType),1)]),_:2},1024))),128))]))])])):(r(),u("div",Ce,[s("h2",Ve,l(d(e)("dashboard.welcome")),1),n(J,{modelValue:p.value,"onUpdate:modelValue":f[1]||(f[1]=o=>p.value=o),label:"User ID",placeholder:"default",onKeyup:Y(I,["enter"]),class:"mb-4",style:{"max-width":"400px"}},null,8,["modelValue"]),n(B,{onClick:I,disabled:!p.value},{default:a(()=>[c(l(d(e)("common.loading")),1)]),_:1},8,["disabled"])]))]),_:1},8,["loading"])])}}});export{Pe as default};
