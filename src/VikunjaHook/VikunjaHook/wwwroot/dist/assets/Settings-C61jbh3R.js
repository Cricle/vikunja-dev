import{d as B,u as D,p as L,o as O,c as R,g as t,t as a,h as l,a as i,w as u,q as T,e as b,b as x,r as p,j as y,f as E}from"./index-BWLevX4m.js";import{u as N}from"./configStore-B2mf_68t.js";const F={class:"pa-4"},q={class:"va-h1 mb-6"},J={class:"mb-6"},Q={class:"va-h4"},$={class:"va-text-secondary"},z={class:"mb-6"},A={class:"va-h4"},P={class:"mb-6"},G={class:"va-h4"},H={class:"va-text-secondary mb-3"},K={class:"va-h4"},W={class:"row row-equal"},X={class:"flex xs12 md6 mb-4"},Y={class:"va-h5 mb-2"},Z={class:"va-text-secondary mb-3"},ee={class:"flex xs12 md6"},te={class:"va-h5 mb-2"},se={class:"va-text-secondary mb-3"},ne=B({__name:"Settings",setup(oe){const{t:e,locale:h}=D(),{applyPreset:_}=L(),v=N(),d=b("auto"),f=b([]),m=b("default"),g=x(()=>v.config),V=x(()=>[{label:e("theme.auto"),value:"auto"},{label:e("theme.light"),value:"light"},{label:e("theme.dark"),value:"dark"}]),C=[{label:"中文",value:"zh"},{label:"English",value:"en"}];function S(){if(d.value==="auto"){const n=window.matchMedia("(prefers-color-scheme: dark)").matches;return e(n?"theme.dark":"theme.light")}return d.value==="dark"?e("theme.dark"):e("theme.light")}function k(n){if(localStorage.setItem("themeMode",n),n==="auto"){const s=window.matchMedia("(prefers-color-scheme: dark)").matches;_(s?"dark":"light")}else _(n)}function I(){if(!g.value)return;const n=JSON.stringify(g.value,null,2),s=new Blob([n],{type:"application/json"}),o=URL.createObjectURL(s),r=document.createElement("a");r.href=o,r.download=`webhook-config-${m.value}-${Date.now()}.json`,r.click(),URL.revokeObjectURL(o)}async function M(n){try{const s=await n.text(),o=JSON.parse(s);if(!o.userId||!o.providers||!o.projectRules)throw new Error("Invalid configuration file");await v.saveConfig(o),await v.loadConfig(m.value)}catch(s){console.error("Failed to import config:",s)}finally{f.value=[]}}return O(()=>{const n=localStorage.getItem("themeMode");n?d.value=n:d.value="auto",k(d.value),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>{d.value==="auto"&&_(o.matches?"dark":"light")}),v.loadConfig(m.value)}),(n,s)=>{const o=p("va-divider"),r=p("va-button-toggle"),U=p("va-input"),w=p("va-button"),j=p("va-file-upload");return E(),R("div",F,[t("h1",q,a(l(e)("settings.title")),1),t("div",J,[i(o,{class:"mb-4"},{default:u(()=>[t("span",Q,a(l(e)("settings.theme")),1)]),_:1}),i(r,{modelValue:d.value,"onUpdate:modelValue":[s[0]||(s[0]=c=>d.value=c),k],options:V.value,class:"mb-3"},null,8,["modelValue","options"]),t("p",$,a(l(e)("theme.current"))+": "+a(S()),1)]),t("div",z,[i(o,{class:"mb-4"},{default:u(()=>[t("span",A,a(l(e)("settings.language")),1)]),_:1}),i(r,{modelValue:l(h),"onUpdate:modelValue":s[1]||(s[1]=c=>T(h)?h.value=c:null),options:C},null,8,["modelValue"])]),t("div",P,[i(o,{class:"mb-4"},{default:u(()=>[t("span",G,a(l(e)("settings.userId")),1)]),_:1}),t("p",H,a(l(e)("settings.userIdDesc")),1),i(U,{modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=c=>m.value=c),readonly:"",style:{"max-width":"400px"}},null,8,["modelValue"])]),t("div",null,[i(o,{class:"mb-4"},{default:u(()=>[t("span",K,a(l(e)("settings.backup")),1)]),_:1}),t("div",W,[t("div",X,[t("h3",Y,a(l(e)("settings.backupTitle")),1),t("p",Z,a(l(e)("settings.backupDesc")),1),i(w,{onClick:I,icon:"download",disabled:!g.value},{default:u(()=>[y(a(l(e)("settings.backupButton")),1)]),_:1},8,["disabled"])]),t("div",ee,[t("h3",te,a(l(e)("settings.restoreTitle")),1),t("p",se,a(l(e)("settings.restoreDesc")),1),i(j,{modelValue:f.value,"onUpdate:modelValue":s[3]||(s[3]=c=>f.value=c),type:"single","file-types":".json",onFileAdded:M},{default:u(()=>[i(w,{icon:"upload"},{default:u(()=>[y(a(l(e)("settings.restoreButton")),1)]),_:1})]),_:1},8,["modelValue"])])])])])}}});export{ne as default};
